<div class="container">
    <div class="dashboard-box">
        <h1 style="color: #90C83C">Team Dashboard</h1>
        <div class="team-info">
            <h2>Team: {{ team.name }}</h2>
            <p class="team-code">Team Code: {{ team.code }}</p>
        </div>

        <div class="player-section">
            <h3>Team Members</h3>
            <div class="members-list" id="members-list">
                {% for member in team_members %}
                    <div class="member-item">
                        {{ member.role }}
                    </div>
                {% empty %}
                    <p>No team members yet</p>
                {% endfor %}
            </div>
        </div>

        <div class="game-status">
            <h3>Game Status</h3>
            <p>Waiting for game to start...</p>
        </div>

        <div class="navigation-buttons">
            <a href="{% url 'join_existing_team' lobby_id=team.lobbies.first.id %}" class="btn home-btn">
                <i class="fas fa-users"></i> Join Team
            </a>
            <a href="{% url 'join_game_session' %}" class="btn change-team-btn">
                <i class="fas fa-home"></i> Back to Home
            </a>
        </div>
    </div>
</div>

<script>
    const teamSocket = new WebSocket(
        'ws://' + window.location.host + 
        '/ws/team/{{ team.id }}/'
    );

    teamSocket.onmessage = function(e) {
        const data = JSON.parse(e.data);
        if (data.type === 'team_members') {
            const membersList = document.getElementById('members-list');
            membersList.innerHTML = '';
            
            data.members.forEach(member => {
                const memberDiv = document.createElement('div');
                memberDiv.className = 'member-item';
                memberDiv.textContent = member;
                membersList.appendChild(memberDiv);
            });
        }
    };

    teamSocket.onclose = function(e) {
        console.error('Team socket closed unexpectedly');
    };
</script>
